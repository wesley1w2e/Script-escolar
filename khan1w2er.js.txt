// Script desenvolvido por Wesley1w2e - VersÃ£o Aprimorada com AutoSolve

const senhasValidas = new Set([
  "estudiolaw",
  "Estudiolaw208", "Estud10law203", "Estudiolaw204", "Estud10law364", "Estud10law907",
  "Estudiolaw945", "estud10law704", "estud10law455", "estud10law471", "estud10law515"
  // ...adicione mais senhas aqui conforme necessidade
]);

const bloqueiaDevtools = () => {
  setInterval(() => {
    const aberto = /./;
    aberto.toString = function() {
      alert("âŒâ”ƒDevTools detectado! Feche para continuar usando o EstÃºdio LAW.");
      window.location.reload();
    };
    console.log("%c", aberto);
  }, 1000);
};

const criaTelaSenha = () => {
  const overlay = document.createElement('div');
  overlay.style.cssText = `
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000c1f;
    z-index: 9999999; display: flex; justify-content: center; align-items: center;
    flex-direction: column; font-family: Arial, sans-serif; color: white;
  `;

  const titulo = document.createElement('h1');
  titulo.textContent = 'EstÃºdio LAW';
  titulo.style = 'font-size: 48px; color: #3399ff; text-shadow: 0 0 15px #3399ff;';

  const input = document.createElement('input');
  input.placeholder = 'Digite a senha...';
  input.type = 'password';
  input.style = 'padding: 10px; font-size: 18px; margin-top: 20px;';

  const btn = document.createElement('button');
  btn.textContent = 'Acessar';
  btn.style = 'padding: 10px 20px; font-size: 18px; margin-top: 10px; cursor: pointer;';

  const aviso = document.createElement('div');
  aviso.style = 'color: red; margin-top: 10px;';

  btn.onclick = () => {
    const senha = input.value.trim();
    if (senhasValidas.has(senha)) {
      document.body.removeChild(overlay);
      iniciarScript();
    } else {
      aviso.textContent = 'Senha incorreta. Tente novamente.';
    }
  };

  overlay.append(titulo, input, btn, aviso);
  document.body.appendChild(overlay);
};

async function iniciarScript() {
  console.clear();
  const delay = ms => new Promise(r => setTimeout(r, ms));

  const style = document.createElement('style');
  style.textContent = `
    @keyframes fogoLAW {
      0% { filter: hue-rotate(0deg); }
      50% { filter: hue-rotate(90deg); }
      100% { filter: hue-rotate(0deg); }
    }
    .lawFire {
      background: linear-gradient(270deg, #001122, #0044cc, #003366, #000022);
      animation: fogoLAW 3s infinite alternate;
    }
  `;
  document.head.appendChild(style);

  const splash = document.createElement('div');
  splash.className = 'lawFire';
  splash.style.cssText = `
    position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;
    align-items:center;z-index:99999;color:#3399ff;font-size:3em;font-family:sans-serif;
    letter-spacing:2px;text-shadow:0 0 15px #3399ff;transition: opacity 1s;
  `;
  splash.textContent = 'EstÃºdio LAW';
  document.body.appendChild(splash);
  await delay(3000);
  splash.style.opacity = '0';
  await delay(1000);
  splash.remove();

  Toastify({
    text: "ğŸ¯â”ƒScript LAW ativado com sucesso!",
    duration: 5000,
    gravity: "bottom",
    position: "center",
    style: { background: "#000", color: "#0cf" }
  }).showToast();

  const clickar = sel => document.querySelector(sel)?.click();
  setInterval(() => {
    clickar('[data-testid="exercise-check-answer"]');
    clickar('[data-testid="exercise-next-question"]');
    clickar('._1udzurba'); // alternativa padrÃ£o

    const inputs = document.querySelectorAll("input[type='text'], input[type='number']");
    if (inputs.length >= 2) {
      inputs[0].value = "1";
      inputs[1].value = "5";
      inputs.forEach(i => i.dispatchEvent(new Event("input", { bubbles: true })));
    }
  }, 1200);
}

// INÃCIO
if (!/^https?:\/\/([a-z0-9-]+\.)?khanacademy\.org/.test(window.location.href)) {
  window.location.href = "https://pt.khanacademy.org/";
} else {
  (async function init() {
    await showSplashScreen();

    await Promise.all([
      loadScript('https://cdn.jsdelivr.net/npm/darkreader/darkreader.min.js', 'darkReaderPlugin').then(() => { DarkReader.setFetchMethod(window.fetch); DarkReader.enable(); }),
      loadCss('https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css'),
      loadScript('https://cdn.jsdelivr.net/npm/toastify-js', 'toastifyPlugin'),
    ]);

    await delay(2000);
    await hideSplashScreen();

    setupMain();
    sendToast("ğŸ€â”ƒKhanResolver LAW iniciado com sucesso!");
    console.clear();
  })();
}

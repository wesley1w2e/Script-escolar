// === Script com senha temporária local, fundo azul animado, fogos e proteção ===

const senhasValidas = {
  "law123": "2025-07-25",
  "eventoX": "2025-08-01"
};

(function bloquearFerramentasDev() {
  document.addEventListener('keydown', function (e) {
    if (
      e.key === 'F12' ||
      (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) ||
      (e.ctrlKey && e.key === 'U')
    ) {
      e.preventDefault();
      alert('Ferramentas de desenvolvedor estão bloqueadas.');
    }
  });

  const checkDevTools = () => {
    const threshold = 160;
    const widthThreshold = window.outerWidth - window.innerWidth > threshold;
    const heightThreshold = window.outerHeight - window.innerHeight > threshold;
    if (widthThreshold || heightThreshold) {
      document.body.innerHTML = '<h1 style="color:white;text-align:center;margin-top:30vh">Acesso bloqueado</h1>';
    }
  };
  setInterval(checkDevTools, 1000);
})();

const style = document.createElement('style');
style.textContent = `
  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  .splash-fire {
    background: linear-gradient(270deg, #001122, #002244, #003366, #001133);
    background-size: 800% 800%;
    animation: gradientMove 6s ease infinite;
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center;
    z-index: 9999; color: #66ccff; font-size: 42px;
    font-family: sans-serif; letter-spacing: 0.1em;
    overflow: hidden; user-select: none;
    text-shadow: 0 0 8px #66ccff, 0 0 20px #3399ff;
  }
  .firework {
    position: absolute; width: 6px; height: 6px; border-radius: 50%;
    background: #66ccff; animation: explode 1s ease-out forwards;
  }
  @keyframes explode {
    0% { transform: translate(0, 0) scale(1); opacity: 1; }
    100% { transform: translate(var(--x), var(--y)) scale(0.5); opacity: 0; }
  }
`;
document.head.appendChild(style);

const splash = document.createElement('div');
splash.className = 'splash-fire';
document.body.appendChild(splash);

const musica = new Audio('https://cdn.pixabay.com/audio/2022/10/30/audio_7cd1e04a69.mp3');
musica.loop = true;
musica.volume = 0.3;

(async () => {
  musica.play();
  const texto = 'Estúdio LAW';
  let i = 0;
  const intervalTexto = setInterval(() => {
    splash.textContent = texto.slice(0, i + 1);
    i++;
    if (i === texto.length) clearInterval(intervalTexto);
  }, 150);

  const intervalFogos = setInterval(() => {
    const f = document.createElement('div');
    f.className = 'firework';
    f.style.left = Math.random() * 100 + '%';
    f.style.top = Math.random() * 100 + '%';
    f.style.setProperty('--x', `${(Math.random() - 0.5) * 200}px`);
    f.style.setProperty('--y', `${(Math.random() - 0.5) * 200}px`);
    splash.appendChild(f);
    setTimeout(() => f.remove(), 1000);
  }, 120);

  await new Promise(res => setTimeout(res, 2500));
  const senha = prompt("Digite a senha de acesso:");
  const hoje = new Date().toISOString().split('T')[0];

  if (!senhasValidas[senha]) {
    alert("Senha inválida.");
    location.reload();
  } else if (hoje > senhasValidas[senha]) {
    alert("⚠️ Acesso expirado. Contate o criador.");
    location.reload();
  } else {
    clearInterval(intervalFogos);
    splash.remove();
    musica.pause();
    alert("✅ Acesso autorizado. Iniciando...");

    // TAREFA AUTOMÁTICA KHAN ACADEMY =====================
    const delay = ms => new Promise(resolve => setTimeout(resolve, ms));
    const findAndClickBySelector = selector => document.querySelector(selector)?.click();

    (async () => {
      const selectors = [
        `[data-testid="choice-icon__library-choice-icon"]`,
        `[data-testid="exercise-check-answer"]`,
        `[data-testid="exercise-next-question"]`,
        `._1udzurba`,
        `._awve9b`
      ];

      window.khanwareDominates = true;

      while (window.khanwareDominates) {
        for (const selector of selectors) {
          findAndClickBySelector(selector);

          const element = document.querySelector(`${selector} > div`);
          if (element?.innerText === "Mostrar resumo") {
            console.log("🎉┃Exercício concluído!");
          }
        }
        await delay(800);
      }
    })();
  }
})();
